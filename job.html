<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Jenkins API Client</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link rel="icon" href="../jenkins_api_client/assets/img/api.png">

    <!-- Le styles -->
    <link href="../jenkins_api_client/assets/css/bootstrap.css" rel="stylesheet">
    <link href="../jenkins_api_client/assets/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="../jenkins_api_client/assets/css/docs.css" rel="stylesheet">
    <link href="../jenkins_api_client/assets/js/google-code-prettify/prettify.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
    </style>
  </head>

  <body onload="prettyPrint()" data-spy="scroll" data-target=".bs-docs-sidebar">

    <!-- Navbar
    ================================================== -->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="#">Jenkins API Client</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class="active"><a href="./index.html">Home</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Classes <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="./client.html">Client</a></li>
                  <li><a href="./job.html">Job</a></li>
                  <li><a href="./node.html">Node</a></li>
                  <li><a href="./system.html">System</a></li>
                </ul>
              </li>
	      <li><a href="./cli.html">CLI</a></li>
              <li><a href="#contact">Contact</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>


<!-- Subhead
================================================== -->
<header>
  <div class="container">
    <div class="hero-unit">
      <h1>Jenkins API Client</h1>
      <p class="lead">Client libraries for communicating with a Jenkins CI server and programatically managing jobs.</p>
    </div>
  </div>
</header>

    <div class="container">

      <!-- Docs nav
      ================================================== -->
      <div class="row">
        <div class="span3 bs-docs-sidebar">
          <ul class="nav nav-list bs-docs-sidenav">
            <li><a href="#about"><i class="icon-chevron-right"></i> About this Class</a></li>
            <li><a href="#listing"><i class="icon-chevron-right"></i> Listing Jobs</a></li>
            <li><a href="#building"><i class="icon-chevron-right"></i> Building Jobs</a></li>
            <li><a href="#restricting"><i class="icon-chevron-right"></i> Restricting to Nodes</a></li>
            <li><a href="#downstream-upstream-projects"><i class="icon-chevron-right"></i> Downstream/Upstream Projects</a></li>
            <li><a href="#chaining"><i class="icon-chevron-right"></i> Chaining Jobs</a></li>
          </ul>
        </div>
        <div class="span9">

          <section id="about">
            <div class="page-header">
              <h2>About this Class</h2>
            </div>
            <p></p>
          </section>

          <section id="listing">
            <div class="page-header">
              <h2>Listing Jobs</h2>
            </div>
            <p></p>
          </section>

          <section id="building">
            <div class="page-header">
              <h2>Building Jobs</h2>
            </div>
            <p></p>
          </section>

          <section id="restricting">
            <div class="page-header">
              <h2>Restricting to Nodes</h2>
            </div>
            <p></p>
          </section>

          <section id="downstream-upstream-projects">
            <div class="page-header">
              <h2>Downstream/Upstream Projects</h2>
            </div>
            <p></p>
          </section>

          <section id="chaining">
            <div class="page-header">
              <h2>Chaining Jobs</h2>
            </div>
            <p>Sometimes we want certain jobs to be added as downstream projects and run them sequencially. 
               The following example will explain how this could be done.</p>
<pre class='brush: rails'>
require 'jenkins_api_client'

# We want to filter all jobs that start with 'test_job'
# Just write a regex to match all the jobs that start with 'test_job'
jobs_to_filter = "^test_job.*"

# Create an instance to jenkins_api_client
@client = JenkinsApi::Client.new(YAML.load_file(File.expand_path('~/.jenkins_api_client/login.yml', __FILE__)))

# Get a filtered list of jobs from the server
jobs = @client.job.list(jobs_to_filter)

# Chain all the jobs with 'success' as the threshold
# The chain method will return the jobs that is in the head of the sequence
# This method will also remove any existing chaining
initial_jobs = @client.job.chain(jobs, 'success', ["all"])

# Now that we have the initial job(s) we can build them
# The build function returns a code from the API which should be 302 if the build was successful
code = @client.job.build(initial_jobs[0])
raise "Could not build the job specified" unless code == 302
</pre>
            <p>In the above example, you might have noticed that the chain method returns an array instead of a single job. 
               There is a reason behind it. In simple chain, such as the one in the example above, all jobs specified 
               are chained one by one. But in some cases they might not be dependent on the previous jobs and 
               we might want to run some jobs parallelly. We just have to specify that as a parameter.</p>

            <p>For example: <code>parallel = 3</code> in the parameter list to the <code>chain</code> method will 
               take the first three jobs and chain them with the next three jobs and so forth till it reaches the 
               end of the list.</p>

            <p>There is another filter option you can specify for the method to take only jobs that are in a particular state. 
               In case if we want to build only jobs that are failed or unstable, we can achieve that by passing in 
               the states in the third parameter. In the example above, we wanted build all jobs. If we just want to 
               build failed and unstable jobs, just pass <code>["failure", "unstable"]</code>. Also if you pass in an 
               empty array, it will assume that you want to consider all jobs and no filtering will be performed.</p>

            <p>There is another parameter called <code>threshold</code> you can specify for the chaining and this 
               is used to decide whether to move forward with the next job in the chain or not. 
               A <code>success</code> will move to the next job only if the current build succeeds, 
               <code>failure</code> will move to the next job even if the build fails, and <code>unstable</code> 
               will move to the job even if the build is unstable.</p>

            <p>The following call to the chain method will consider only failed and unstable jobs, 
               <code>chain</code> then with 'failure' as the threshold, and also chain three jobs in parallel.</p>

<pre>
initial_jobs = @client.job.chain(jobs, 'failure', ["failure", "unstable"], 3)
# We will receive three jobs as a result and we can build them all
initial_jobs.each { |job|
  code = @client.job.build(job)
  raise "Unable to build job: #{job}" unless code == 302
}
</pre>
          </section>

        </div>
      </div>
    </div> <!-- /container -->

    <!-- Footer
    =============================================== -->
    <footer class="footer">
      <div class="container">
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p>&copy; 2012 Arangamanikkannan (Kannan) Manickam. All rights reserved.</p>
        <p>Designed with <a href = "http://twitter.github.com/bootstrap/index.html">Twitter Bootstrap </a>on <a href="http://www.vim.org/">Vim</a> and hosted using <a href="http://pages.github.com/">Github Pages</a>.</p>
        <ul class="footer-links">
          <li><a href="http://github.com/arangamani/jenkins_api_client">Github</a></li>
          <li class="muted">&middot;</li>
          <li><a href="https://github.com/arangamani/jenkins_api_client/issues">Issues</a></li>
          <li class="muted">&middot;</li>
          <li><a href="http://rubygems.org/gems/jenkins_api_client">Rubygem</a></li>
          <li class="muted">&middot;</li>
          <li><a href="http://rubydoc.info/github/arangamani/jenkins_api_client">RubyDoc</a></li>
          <li class="muted">&middot;</li>
          <li><a href="http://jenkins-ci.org/">Jenkins</a></li>
        </ul>
      </div>
    </footer>

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
    <script src="../jenkins_api_client/assets/js/jquery.js"></script>
    <script src="../jenkins_api_client/assets/js/google-code-prettify/prettify.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-transition.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-alert.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-modal.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-dropdown.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-scrollspy.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-tab.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-tooltip.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-popover.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-button.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-collapse.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-carousel.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-typeahead.js"></script>
    <script src="../jenkins_api_client/assets/js/bootstrap-affix.js"></script>
    <script src="../jenkins_api_client/assets/js/application.js"></script>

  </body>
</html>
