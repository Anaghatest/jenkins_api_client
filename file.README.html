<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.7
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'>
<h1 id="label-Jenkins+API+Client">Jenkins API Client</h1>

<p><img src="https://badge.fury.io/rb/jenkins_api_client.png" />] <a
href="https://travis-ci.org/arangamani/jenkins_api_client.png?branch=master">Status</a>] <img
src="https://gemnasium.com/arangamani/jenkins_api_client.png" />] <img
src="https://codeclimate.com/github/arangamani/jenkins_api_client.png" />]</p>

<p>Copyright © 2012-2013, Kannan Manickam <img
src="http://api.coderwall.com/arangamani/endorsecount.png" />]</p>

<p>Client libraries for communicating with a Jenkins CI server and
programatically managing jobs.</p>

<p>IRC Channel: ##jenkins-api-client (on freenode)</p>

<p>Mailing list: jenkins_api_client@googlegroups.com</p>

<p>Google Group: <a
href="https://groups.google.com/group/jenkins_api_client">groups.google.com/group/jenkins_api_client</a></p>

<h2 id="label-OVERVIEW%3A">OVERVIEW:</h2>

<p>This project is a simple API client for interacting with Jenkins Continuous
Integration server. Jenkins provides three kinds of remote access API. 1.
XML API, 2. JSON API, and 3. Python API. This project aims at consuming the
JSON API and provides some useful functions for controlling jobs on the
Jenkins programatically. Even though Jenkins provides an awesome UI for
controlling jobs, it would be nice and helpful to have a programmable
interface so we can dynamically and automatically manage jobs and other
artifacts.</p>

<h2 id="label-DETAILS%3A">DETAILS:</h2>

<p>This projects currently only provides functionality for the <code>jobs,
node, view, system, and build queue</code> interfaces.</p>

<h2 id="label-USAGE%3A">USAGE:</h2>

<h3 id="label-Installation">Installation</h3>

<p>Install jenkins_api_client by <code>sudo gem install
jenkins_api_client</code> Include this gem in your code as a require
statement.</p>

<pre class="code ruby"><code class="ruby"><span class='rubyid_require identifier id'>require</span> <span class='string val'>'jenkins_api_client'</span>
</code></pre>

<h3 id="label-Using+with+IRB">Using with IRB</h3>

<p>If you want to just play with it and not actually want to write a script,
you can just use the irb launcher script which is available in
<code>scripts/login_with_irb.rb</code>. But make sure that you have your
credentials available in the correct location. By default the script
assumes that you have your credentials file in
<code>~/.jenkins_api_client/login.yml</code>. If you don’t prefer this
location and would like to use a different location, just modify that
script to point to the location where the credentials file exists.</p>

<pre class="code ruby"><code class="ruby"><span class='rubyid_ruby identifier id'>ruby</span> <span class='rubyid_scripts identifier id'>scripts</span><span class='div op'>/</span><span class='rubyid_login_with_irb identifier id'>login_with_irb</span><span class='dot token'>.</span><span class='rubyid_rb identifier id'>rb</span>
</code></pre>

<p>You will see the that it entered IRB session and you can play with the API
client with the <code>@client</code> object that it has returned.</p>

<h3 id="label-Authentication">Authentication</h3>

<p>Supplying credentials to the client is optional, as not all Jenkins
instances require authentication. This project supports two types of
password-based authentication. You can just you the plain password by using
<code>password</code> parameter. If you don’t prefer leaving plain
passwords in the credentials file, you can encode your password in base64
format and use <code>password_base64</code> parameter to specify the
password either in the arguments or in the credentials file. To use the
client without credentials, just leave out the <code>username</code> and
<code>password</code> parameters. The <code>password</code> parameter is
only required if <code>username</code> is specified.</p>

<h3 id="label-Cross-site+Scripting+%28XSS%29+and+Crumb+Support">Cross-site Scripting (XSS) and Crumb Support</h3>

<p>Support for Jenkins crumbs has been added. These allow an application to
use the Jenkins API POST methods without requiring the ‘Prevent Cross
Site Request Forgery exploits’ to be disabled. The API will check in with
the Jenkins server to determine whether crumbs are enabled or not, and use
them if appropriate.</p>

<h3 id="label-Basic+Usage">Basic Usage</h3>

<p>As discussed earlier, you can either specify all the credentials and server
information as parameters to the Client or have a credentials file and just
parse the yaml file and pass it in. The following call just passes the
information as parameters</p>

<pre class="code ruby"><code class="ruby"><span class='rubyid_@client ivar id'>@client</span> <span class='assign token'>=</span> <span class='rubyid_JenkinsApi constant id'>JenkinsApi</span><span class='colon2 op'>::</span><span class='rubyid_Client constant id'>Client</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:server_ip</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'0.0.0.0'</span><span class='comma token'>,</span>
         <span class='symbol val'>:username</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'somename'</span><span class='comma token'>,</span> <span class='symbol val'>:password</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'secret password'</span><span class='rparen token'>)</span>
<span class='comment val'># The following call will return all jobs matching 'Testjob'</span>
<span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_@client ivar id'>@client</span><span class='dot token'>.</span><span class='rubyid_job identifier id'>job</span><span class='dot token'>.</span><span class='rubyid_list identifier id'>list</span><span class='lparen token'>(</span><span class='string val'>&quot;^Testjob&quot;</span><span class='rparen token'>)</span>
</code></pre>

<p>The following example passes the YAML file contents. An example yaml file
is located in <code>config/login.yml.example</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='rubyid_@client ivar id'>@client</span> <span class='assign token'>=</span> <span class='rubyid_JenkinsApi constant id'>JenkinsApi</span><span class='colon2 op'>::</span><span class='rubyid_Client constant id'>Client</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_YAML constant id'>YAML</span><span class='dot token'>.</span><span class='rubyid_Load_file constant id'>Load_file</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_expand_path identifier id'>expand_path</span><span class='lparen token'>(</span>
  <span class='string val'>&quot;~/.jenkins_api_client/login.yml&quot;</span><span class='comma token'>,</span> <span class='rubyid___FILE__ __file__ kw'>__FILE__</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='comment val'># The following call lists all jobs</span>
<span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_@client ivar id'>@client</span><span class='dot token'>.</span><span class='rubyid_job identifier id'>job</span><span class='dot token'>.</span><span class='rubyid_list_all identifier id'>list_all</span>
</code></pre>

<h3 id="label-Chaining+and+Building+Jobs">Chaining and Building Jobs</h3>

<p>Sometimes we want certain jobs to be added as downstream projects and run
them sequencially. The following example will explain how this could be
done.</p>

<pre class="code ruby"><code class="ruby"><span class='rubyid_require identifier id'>require</span> <span class='string val'>'jenkins_api_client'</span>

<span class='comment val'># We want to filter all jobs that start with 'test_job'</span>
<span class='comment val'># Just write a regex to match all the jobs that start with 'test_job'</span>
<span class='rubyid_jobs_to_filter identifier id'>jobs_to_filter</span> <span class='assign token'>=</span> <span class='string val'>&quot;^test_job.*&quot;</span>

<span class='comment val'># Create an instance to jenkins_api_client</span>
<span class='rubyid_@client ivar id'>@client</span> <span class='assign token'>=</span> <span class='rubyid_JenkinsApi constant id'>JenkinsApi</span><span class='colon2 op'>::</span><span class='rubyid_Client constant id'>Client</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_YAML constant id'>YAML</span><span class='dot token'>.</span><span class='rubyid_load_file identifier id'>load_file</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_expand_path identifier id'>expand_path</span><span class='lparen token'>(</span>
  <span class='string val'>&quot;~/.jenkins_api_client/login.yml&quot;</span><span class='comma token'>,</span> <span class='rubyid___FILE__ __file__ kw'>__FILE__</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

<span class='comment val'># Get a filtered list of jobs from the server</span>
<span class='rubyid_jobs identifier id'>jobs</span> <span class='assign token'>=</span> <span class='rubyid_@client ivar id'>@client</span><span class='dot token'>.</span><span class='rubyid_job identifier id'>job</span><span class='dot token'>.</span><span class='rubyid_list identifier id'>list</span><span class='lparen token'>(</span><span class='rubyid_jobs_to_filter identifier id'>jobs_to_filter</span><span class='rparen token'>)</span>

<span class='comment val'># Chain all the jobs with 'success' as the threshold</span>
<span class='comment val'># The chain method will return the jobs that is in the head of the sequence</span>
<span class='comment val'># This method will also remove any existing chaining</span>
<span class='rubyid_initial_jobs identifier id'>initial_jobs</span> <span class='assign token'>=</span> <span class='rubyid_@client ivar id'>@client</span><span class='dot token'>.</span><span class='rubyid_job identifier id'>job</span><span class='dot token'>.</span><span class='rubyid_chain identifier id'>chain</span><span class='lparen token'>(</span><span class='rubyid_jobs identifier id'>jobs</span><span class='comma token'>,</span> <span class='string val'>'success'</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>&quot;all&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

<span class='comment val'># Now that we have the initial job(s) we can build them</span>
<span class='comment val'># The build function returns a code from the API which should be 302 if</span>
<span class='comment val'># the build was successful</span>
<span class='rubyid_code identifier id'>code</span> <span class='assign token'>=</span> <span class='rubyid_@client ivar id'>@client</span><span class='dot token'>.</span><span class='rubyid_job identifier id'>job</span><span class='dot token'>.</span><span class='rubyid_build identifier id'>build</span><span class='lparen token'>(</span><span class='rubyid_initial_jobs identifier id'>initial_jobs</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='rubyid_raise identifier id'>raise</span> <span class='string val'>&quot;Could not build the job specified&quot;</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_code identifier id'>code</span> <span class='eq op'>==</span> <span class='integer val'>302</span>
</code></pre>

<p>In the above example, you might have noticed that the chain method returns
an array instead of a single job. There is a reason behind it. In simple
chain, such as the one in the example above, all jobs specified are chained
one by one. But in some cases they might not be dependent on the previous
jobs and we might want to run some jobs parallelly. We just have to specify
that as a parameter.</p>

<p>For example: <code>parallel = 3</code> in the parameter list to the
<code>chain</code> method will take the first three jobs and chain them
with the next three jobs and so forth till it reaches the end of the list.</p>

<p>There is another filter option you can specify for the method to take only
jobs that are in a particular state. In case if we want to build only jobs
that are failed or unstable, we can achieve that by passing in the states
in the third parameter. In the example above, we wanted build all jobs. If
we just want to build failed and unstable jobs, just pass
<code>[&quot;failure&quot;, &quot;unstable&quot;]</code>. Also if you pass
in an empty array, it will assume that you want to consider all jobs and no
filtering will be performed.</p>

<p>There is another parameter called <code>threshold</code> you can specify
for the chaining and this is used to decide whether to move forward with
the next job in the chain or not. A <code>success</code> will move to the
next job only if the current build succeeds, <code>failure</code> will move
to the next job even if the build fails, and <code>unstable</code> will
move to the job even if the build is unstable.</p>

<p>The following call to the <code>chain</code> method will consider only
failed and unstable jobs, chain then with ‘failure’ as the threshold,
and also chain three jobs in parallel.</p>

<pre class="code ruby"><code class="ruby"><span class='rubyid_initial_jobs identifier id'>initial_jobs</span> <span class='assign token'>=</span> <span class='rubyid_@client ivar id'>@client</span><span class='dot token'>.</span><span class='rubyid_job identifier id'>job</span><span class='dot token'>.</span><span class='rubyid_chain identifier id'>chain</span><span class='lparen token'>(</span><span class='rubyid_jobs identifier id'>jobs</span><span class='comma token'>,</span> <span class='string val'>'failure'</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>&quot;failure&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;unstable&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='rparen token'>)</span>
<span class='comment val'># We will receive three jobs as a result and we can build them all</span>
<span class='rubyid_initial_jobs identifier id'>initial_jobs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_job identifier id'>job</span><span class='bitor op'>|</span>
  <span class='rubyid_code identifier id'>code</span> <span class='assign token'>=</span> <span class='rubyid_@client ivar id'>@client</span><span class='dot token'>.</span><span class='rubyid_job identifier id'>job</span><span class='dot token'>.</span><span class='rubyid_build identifier id'>build</span><span class='lparen token'>(</span><span class='rubyid_job identifier id'>job</span><span class='rparen token'>)</span>
  <span class='rubyid_raise identifier id'>raise</span> <span class='dstring node'>&quot;Unable to build job: #{job&quot; unless code == 302
end
</span></code></pre>

<h3 id="label-Running+Jenkins+CLI">Running Jenkins CLI</h3>

<p>To running <a
href="https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+CLI">Jenkins
CLI</a></p>
<ul><li>
<p>authentication with username/password (deprecated)</p>
</li></ul>

<pre class="code ruby"><code class="ruby"><span class='rubyid_@client ivar id'>@client</span> <span class='assign token'>=</span> <span class='rubyid_JenkinsApi constant id'>JenkinsApi</span><span class='colon2 op'>::</span><span class='rubyid_Client constant id'>Client</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:server_ip</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'127.0.0.1'</span><span class='comma token'>,</span>
         <span class='symbol val'>:username</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'somename'</span><span class='comma token'>,</span> <span class='symbol val'>:password</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'secret password'</span><span class='rparen token'>)</span>
<span class='comment val'># The following call will return the version of Jenkins instance</span>
<span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_@client ivar id'>@client</span><span class='dot token'>.</span><span class='rubyid_exec_cli identifier id'>exec_cli</span><span class='lparen token'>(</span><span class='string val'>&quot;version&quot;</span><span class='rparen token'>)</span>
</code></pre>
<ul><li>
<p>authentication with public/private key file remember to upload the public
key to <a href="http://<Server"><Server</a> IP&gt;:&lt;Server
Port&gt;/user/&lt;Username&gt;/configure</p>
</li></ul>

<pre class="code ruby"><code class="ruby"><span class='rubyid_@client ivar id'>@client</span> <span class='assign token'>=</span> <span class='rubyid_JenkinsApi constant id'>JenkinsApi</span><span class='colon2 op'>::</span><span class='rubyid_Client constant id'>Client</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:server_ip</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'127.0.0.1'</span><span class='comma token'>,</span>
         <span class='symbol val'>:identity_file</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'~/.ssh/id_rsa'</span><span class='rparen token'>)</span>
<span class='comment val'># The following call will return the version of Jenkins instance</span>
<span class='rubyid_puts identifier id'>puts</span> <span class='rubyid_@client ivar id'>@client</span><span class='dot token'>.</span><span class='rubyid_exec_cli identifier id'>exec_cli</span><span class='lparen token'>(</span><span class='string val'>&quot;version&quot;</span><span class='rparen token'>)</span>
</code></pre>

<p>Before you run the CLI, please make sure the following requirements are
fulfilled: * JRE/JDK 6 (or above) is installed, and ‘java’ is on the
$PATH environment  variable * The
<code>jenkins_api_client/java_deps/jenkins-cli.jar</code> is required as
the  client to run the CLI. You can retrieve the available commands via
accessing  the URL: <code>http://<server>:<port>/cli</code> * (Optional)
required if you run the Groovy Script through CLI, make sure  the
<em>user</em> have the privilige to run script</p>

<h3 id="label-Using+with+command+line">Using with command line</h3>

<p>Command line interface is supported only from version 0.2.0. See help using
<code>jenkinscli help</code></p>

<p>There are three ways for authentication using command line interface 1.
Passing all credentials and server information using command line
parameters 2. Passing the credentials file as the command line parameter 3.
Having the credentials file in the default location 
<code>HOME/.jenkins_api_client/login.yml</code></p>

<h3 id="label-Debug">Debug</h3>

<p>As of v0.13.0, this debug parameter is removed. Use the logger instead. See
the next section for more information about this option.</p>

<h3 id="label-Logger">Logger</h3>

<p>As of v0.13.0, support for logger is introduced. Since it would be nice to
have the activities of the jenkins_api_client in a log file, this feature
is implemented using the Ruby’s standard Logger class. For using this
feature, there are two new input arguments used during the initialization
of Client.</p>
<ol><li>
<p><code>:log_location</code> - This argument specifies the location for the
log file. A  good location for linux based systems would be 
‘/var/log/jenkins_api_client.log’. The default for this values is
STDOUT.  This will print the log messages on the console itself.</p>
</li><li>
<p><code>:log_level</code> - This argument specifies the level of messages to
be logged.  It should be one of Logger::DEBUG (0), Logger::INFO (1),
Logger::WARN (2),  Logger::ERROR (3), Logger::FATAL (4). It can be
specified either using the  constants available in the Logger class or
using these integers provided  here. The default for this argument is
Logger::INFO (1)</p>
</li></ol>

<p>If you want customization on the functionality Logger provides such as
leave n old log files, open the log file in append mode, create your own
logger and then set that in the client.</p>

<h4 id="label-Examples">Examples</h4>

<pre class="code ruby"><code class="ruby"><span class='rubyid_@client ivar id'>@client</span> <span class='assign token'>=</span> <span class='rubyid_JenkinsApi constant id'>JenkinsApi</span><span class='colon2 op'>::</span><span class='rubyid_Client constant id'>Client</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dot3 op'>...</span><span class='rparen token'>)</span>
  <span class='comment val'># Create a logger which ages logfile once it reaches a certain size. Leave 10</span>
  <span class='comment val'># “old log files” and each file is about 1,024,000 bytes.</span>
  <span class='rubyid_@client ivar id'>@client</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span> <span class='assign token'>=</span> <span class='rubyid_Logger constant id'>Logger</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'foo.log'</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='comma token'>,</span> <span class='integer val'>1024000</span><span class='rparen token'>)</span>
</code></pre>

<p>Please refer to <a
href="http://www.ruby-doc.org/stdlib-1.9.3/libdoc/logger/rdoc/Logger.html">Ruby
Logger</a> for more information.</p>

<h2 id="label-CONTRIBUTING%3A">CONTRIBUTING:</h2>

<p>If you would like to contribute to this project, just do the following:</p>
<ol><li>
<p>Fork the repo on Github.</p>
</li><li>
<p>Add your features and make commits to your forked repo.</p>
</li><li>
<p>Make a pull request to this repo.</p>
</li><li>
<p>Review will be done and changes will be requested.</p>
</li><li>
<p>Once changes are done or no changes are required, pull request will be
merged.</p>
</li><li>
<p>The next release will have your changes in it.</p>
</li></ol>

<p>Please take a look at the issues page if you want to get started.</p>

<h2 id="label-FEATURE+REQUEST%3A">FEATURE REQUEST:</h2>

<p>If you use this gem for your project and you think it would be nice to have
a particular feature that is presently not implemented, I would love to
hear that and consider working on it. Just open an issue in Github as a
feature request.</p>
</div></div>

    <div id="footer">
  Generated on Tue Sep 10 01:41:27 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7 (ruby-1.8.7).
</div>

        <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-37519629-2']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      </script>
    </body>

</html>