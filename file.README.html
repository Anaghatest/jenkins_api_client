<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.6.2
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'><h1>Jenkins API Client</h1>

<p><a href="http://rubygems.org/gems/jenkins_api_client"><img src="https://badge.fury.io/rb/jenkins_api_client.png" alt="Gem Version"></a>
<a href="https://travis-ci.org/arangamani/jenkins_api_client"><img src="https://travis-ci.org/arangamani/jenkins_api_client.png?branch=master" alt="Build Status"></a>
<a href="https://gemnasium.com/arangamani/jenkins_api_client"><img src="https://gemnasium.com/arangamani/jenkins_api_client.png" alt="Dependency Status"></a>
<a href="https://codeclimate.com/github/arangamani/jenkins_api_client"><img src="https://codeclimate.com/github/arangamani/jenkins_api_client.png" alt="Code Climate"></a></p>

<p>Copyright &copy; 2012-2013, Kannan Manickam <a href="http://coderwall.com/arangamani"><img src="http://api.coderwall.com/arangamani/endorsecount.png" alt="endorse"></a></p>

<p>Client libraries for communicating with a Jenkins CI server and programatically managing jobs.</p>

<p>IRC Channel: ##jenkins-api-client</p>

<p>Mailing list: <a href="mailto:jenkins_api_client@googlegroups.com">jenkins_api_client@googlegroups.com</a></p>

<p>Google Group: <a href="https://groups.google.com/group/jenkins_api_client">https://groups.google.com/group/jenkins_api_client</a></p>

<h2>OVERVIEW:</h2>

<p>This project is a simple API client for interacting with Jenkins Continuous
Integration server. Jenkins provides three kinds of remote access API.
1. XML API, 2. JSON API, and 3. Python API. This project aims at consuming the
JSON API and provides some useful functions for controlling jobs on the Jenkins
programatically. Even though Jenkins provides an awesome UI for controlling
jobs, it would be nice and helpful to have a programmable interface so we can
dynamically and automatically manage jobs and other artifacts.</p>

<h2>DETAILS:</h2>

<p>This projects currently only provides functionality for the
<tt>jobs, node, view, system, and build queue</tt> interfaces.</p>

<h2>USAGE:</h2>

<h3>Installation</h3>

<p>Install jenkins_api_client by <tt>sudo gem install jenkins_api_client</tt>
Include this gem in your code as a require statement.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>jenkins_api_client</span><span class='tstring_end'>'</span></span>
</code></pre>

<h3>Using with IRB</h3>

<p>If you want to just play with it and not actually want to write a script, you
can just use the irb launcher script which is available in
<tt>scripts/login_with_irb.rb</tt>. But make sure that you have your credentials
available in the correct location. By default the script assumes that you have
your credentials file in <tt>~/.jenkins_api_client/login.yml</tt>. If you don&#39;t
prefer this location and would like to use a different location, just modify
that script to point to the location where the credentials file exists.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ruby'>ruby</span> <span class='id identifier rubyid_scripts'>scripts</span><span class='op'>/</span><span class='id identifier rubyid_login_with_irb'>login_with_irb</span><span class='period'>.</span><span class='id identifier rubyid_rb'>rb</span>
</code></pre>

<p>You will see the that it entered IRB session and you can play with the API
client with the <tt>@client</tt> object that it has returned.</p>

<h3>Authentication</h3>

<p>Supplying credentials to the client is optional, as not all Jenkins instances
require authentication. This project supports two types of password-based
authentication. You can just you the plain password by using <tt>password</tt>
parameter. If you don&#39;t prefer leaving plain passwords in the credentials file,
you can encode your password in base64 format and use <tt>password_base64</tt>
parameter to specify the password either in the arguments or in the credentials
file. To use the client without credentials, just leave out the
<tt>username</tt> and <tt>password</tt> parameters. The <tt>password</tt>
parameter is only required if <tt>username</tt> is specified.</p>

<h3>Basic Usage</h3>

<p>As discussed earlier, you can either specify all the credentials and server
information as parameters to the Client or have a credentials file and just
parse the yaml file and pass it in. The following call just passes the
information as parameters</p>

<pre class="code ruby"><code class="ruby"><span class='ivar'>@client</span> <span class='op'>=</span> <span class='const'>JenkinsApi</span><span class='op'>::</span><span class='const'>Client</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:server_ip</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
         <span class='symbol'>:username</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>somename</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:password</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>secret password</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='comment'># The following call will return all jobs matching 'Testjob'
</span><span class='id identifier rubyid_puts'>puts</span> <span class='ivar'>@client</span><span class='period'>.</span><span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>^Testjob</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>

<p>The following example passes the YAML file contents. An example yaml file is
located in <tt>config/login.yml.example</tt>.</p>

<pre class="code ruby"><code class="ruby"><span class='ivar'>@client</span> <span class='op'>=</span> <span class='const'>JenkinsApi</span><span class='op'>::</span><span class='const'>Client</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>YAML</span><span class='period'>.</span><span class='const'>Load_file</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>~/.jenkins_api_client/login.yml</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>__FILE__</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='comment'># The following call lists all jobs
</span><span class='id identifier rubyid_puts'>puts</span> <span class='ivar'>@client</span><span class='period'>.</span><span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_list_all'>list_all</span>
</code></pre>

<h3>Chaining and Building Jobs</h3>

<p>Sometimes we want certain jobs to be added as downstream projects and run them
sequencially. The following example will explain how this could be done.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>jenkins_api_client</span><span class='tstring_end'>'</span></span>

<span class='comment'># We want to filter all jobs that start with 'test_job'
</span><span class='comment'># Just write a regex to match all the jobs that start with 'test_job'
</span><span class='id identifier rubyid_jobs_to_filter'>jobs_to_filter</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>^test_job.*</span><span class='tstring_end'>&quot;</span></span>

<span class='comment'># Create an instance to jenkins_api_client
</span><span class='ivar'>@client</span> <span class='op'>=</span> <span class='const'>JenkinsApi</span><span class='op'>::</span><span class='const'>Client</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>YAML</span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>~/.jenkins_api_client/login.yml</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='kw'>__FILE__</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>

<span class='comment'># Get a filtered list of jobs from the server
</span><span class='id identifier rubyid_jobs'>jobs</span> <span class='op'>=</span> <span class='ivar'>@client</span><span class='period'>.</span><span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='id identifier rubyid_jobs_to_filter'>jobs_to_filter</span><span class='rparen'>)</span>

<span class='comment'># Chain all the jobs with 'success' as the threshold
</span><span class='comment'># The chain method will return the jobs that is in the head of the sequence
</span><span class='comment'># This method will also remove any existing chaining
</span><span class='id identifier rubyid_initial_jobs'>initial_jobs</span> <span class='op'>=</span> <span class='ivar'>@client</span><span class='period'>.</span><span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_chain'>chain</span><span class='lparen'>(</span><span class='id identifier rubyid_jobs'>jobs</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>success</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>all</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>

<span class='comment'># Now that we have the initial job(s) we can build them
</span><span class='comment'># The build function returns a code from the API which should be 302 if
</span><span class='comment'># the build was successful
</span><span class='id identifier rubyid_code'>code</span> <span class='op'>=</span> <span class='ivar'>@client</span><span class='period'>.</span><span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='id identifier rubyid_initial_jobs'>initial_jobs</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not build the job specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_code'>code</span> <span class='op'>==</span> <span class='int'>302</span>
</code></pre>

<p>In the above example, you might have noticed that the chain method returns an
array instead of a single job. There is a reason behind it. In simple chain,
such as the one in the example above, all jobs specified are chained one by
one. But in some cases they might not be dependent on the previous jobs and we
might want to run some jobs parallelly. We just have to specify that as a
parameter.</p>

<p>For example: <tt>parallel = 3</tt> in the parameter list to the <tt>chain</tt>
method will take the first three jobs and chain them with the next three jobs
and so forth till it reaches the end of the list.</p>

<p>There is another filter option you can specify for the method to take only
jobs that are in a particular state. In case if we want to build only jobs
that are failed or unstable, we can achieve that by passing in the states in
the third parameter. In the example above, we wanted build all jobs. If we just
want to build failed and unstable jobs, just pass
<tt>[&quot;failure&quot;, &quot;unstable&quot;]</tt>. Also if you pass in an empty array, it will
assume that you want to consider all jobs and no filtering will be performed.</p>

<p>There is another parameter called <tt>threshold</tt> you can specify for the
chaining and this is used to decide whether to move forward with the next job
in the chain or not. A <tt>success</tt> will move to the next job only if the
current build succeeds, <tt>failure</tt> will move to the next job even if the
build fails, and <tt>unstable</tt> will move to the job even if the build is
unstable.</p>

<p>The following call to the <tt>chain</tt> method will consider only failed and
unstable jobs, chain then with &#39;failure&#39; as the threshold, and also chain three
jobs in parallel.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_initial_jobs'>initial_jobs</span> <span class='op'>=</span> <span class='ivar'>@client</span><span class='period'>.</span><span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_chain'>chain</span><span class='lparen'>(</span><span class='id identifier rubyid_jobs'>jobs</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>failure</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>failure</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unstable</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>3</span><span class='rparen'>)</span>
<span class='comment'># We will receive three jobs as a result and we can build them all
</span><span class='id identifier rubyid_initial_jobs'>initial_jobs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_job'>job</span><span class='op'>|</span>
  <span class='id identifier rubyid_code'>code</span> <span class='op'>=</span> <span class='ivar'>@client</span><span class='period'>.</span><span class='id identifier rubyid_job'>job</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='id identifier rubyid_job'>job</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unable to build job: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_job'>job</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_code'>code</span> <span class='op'>==</span> <span class='int'>302</span>
<span class='kw'>end</span>
</code></pre>

<h3>Running Jenkins CLI</h3>

<p>To running <a href="https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+CLI">Jenkins CLI</a></p>

<ul>
<li>authentication with username/password (deprecated)</li>
</ul>

<pre class="code ruby"><code class="ruby"><span class='ivar'>@client</span> <span class='op'>=</span> <span class='const'>JenkinsApi</span><span class='op'>::</span><span class='const'>Client</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:server_ip</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
         <span class='symbol'>:username</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>somename</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:password</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>secret password</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='comment'># The following call will return the version of Jenkins instance
</span><span class='id identifier rubyid_puts'>puts</span> <span class='ivar'>@client</span><span class='period'>.</span><span class='id identifier rubyid_exec_cli'>exec_cli</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>version</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>

<ul>
<li>authentication with public/private key file
remember to upload the public key to http://#server_ip:#server_port/user/#my_username/configure</li>
</ul>

<pre class="code ruby"><code class="ruby"><span class='ivar'>@client</span> <span class='op'>=</span> <span class='const'>JenkinsApi</span><span class='op'>::</span><span class='const'>Client</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:server_ip</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
         <span class='symbol'>:identity_file</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>~/.ssh/id_rsa</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='comment'># The following call will return the version of Jenkins instance
</span><span class='id identifier rubyid_puts'>puts</span> <span class='ivar'>@client</span><span class='period'>.</span><span class='id identifier rubyid_exec_cli'>exec_cli</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>version</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>

<p>Before you run the CLI, please make sure the following requirements are
fulfilled:
* JRE/JDK 6 (or above) is installed, and &#39;java&#39; is on the $PATH environment
  variable
* The <code>jenkins_api_client/java_deps/jenkins-cli.jar</code> is required as the
  client to run the CLI. You can retrieve the available commands via accessing
  the URL: <code>http://&lt;server&gt;:&lt;port&gt;/cli</code>
* (Optional) required if you run the Groovy Script through CLI, make sure
  the <em>user</em> have the privilige to run script</p>

<h3>Using with command line</h3>

<p>Command line interface is supported only from version 0.2.0.
See help using <tt>jenkinscli help</tt></p>

<p>There are three ways for authentication using command line interface
1. Passing all credentials and server information using command line parameters
2. Passing the credentials file as the command line parameter
3. Having the credentials file in the default location
   <tt>HOME/.jenkins_api_client/login.yml</tt></p>

<h3>Debug</h3>

<p>As of v0.13.0, this debug parameter is removed. Use the logger instead. See the
next section for more information about this option.</p>

<h3>Logger</h3>

<p>As of v0.13.0, support for logger is introduced. Since it would be nice to have
the activities of the jenkins_api_client in a log file, this feature is
implemented using the Ruby&#39;s standard Logger class. For using this feature,
there are two new input arguments used during the initialization of Client.</p>

<ol>
<li><code>:log_location</code> - This argument specifies the location for the log file. A
good location for linux based systems would be
&#39;/var/log/jenkins_api_client.log&#39;. The default for this values is STDOUT.
This will print the log messages on the console itself.</li>
<li><code>:log_level</code> - This argument specifies the level of messages to be logged.
It should be one of Logger::DEBUG (0), Logger::INFO (1), Logger::WARN (2),
Logger::ERROR (3), Logger::FATAL (4). It can be specified either using the
constants available in the Logger class or using these integers provided
here. The default for this argument is Logger::INFO (1)</li>
</ol>

<p>If you want customization on the functionality Logger provides such as leave n
old log files, open the log file in append mode, create your own logger and
then set that in the client.</p>

<h4>Examples</h4>

<pre class="code ruby"><code class="ruby">  @client = JenkinsApi::Client.new(...)
  # Create a logger which ages logfile once it reaches a certain size. Leave 10
  # “old log files” and each file is about 1,024,000 bytes.
  @client.logger = Logger.new('foo.log', 10, 1024000)
</code></pre>

<p>Please refer to <a href="http://www.ruby-doc.org/stdlib-1.9.3/libdoc/logger/rdoc/Logger.html">Ruby
Logger</a>
for more information.</p>

<h2>CONTRIBUTING:</h2>

<p>If you would like to contribute to this project, just do the following:</p>

<ol>
<li>Fork the repo on Github.</li>
<li>Add your features and make commits to your forked repo.</li>
<li>Make a pull request to this repo.</li>
<li>Review will be done and changes will be requested.</li>
<li>Once changes are done or no changes are required, pull request will be merged.</li>
<li>The next release will have your changes in it.</li>
</ol>

<p>Please take a look at the issues page if you want to get started.</p>

<h2>FEATURE REQUEST:</h2>

<p>If you use this gem for your project and you think it would be nice to have a
particular feature that is presently not implemented, I would love to hear that
and consider working on it. Just open an issue in Github as a feature request.</p>
</div></div>

    <div id="footer">
  Generated on Tue Jul  9 23:23:50 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.6.2 (ruby-1.9.3).
</div>

  </body>
</html>